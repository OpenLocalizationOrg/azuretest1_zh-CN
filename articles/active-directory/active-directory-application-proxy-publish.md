---
ms.openlocfilehash: de0432273ccc9a95b92ff954d5b693dfdbc667bd
ms.sourcegitcommit: bab1265d669c3e6871daa7cb8a5640a47104947a
translationtype: MT
---
<properties
    pageTitle="与 AD Azure 应用程序代理的发布应用程序"
    description="介绍如何发布使用 Azure AD 应用程序代理服务器的内部应用程序。"
    services="active-directory"
    documentationCenter=""
    authors="rkarlin"
    manager="terrylan"
    editor=""/>

<tags
    ms.service="active-directory"
    ms.workload="identity"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="06/02/2015"
    ms.author="rkarlin"/>


# 发布应用程序使用 Azure AD 应用程序代理服务器

> [AZURE.NOTE] 应用程序代理服务器是仅当您升级到特优或 Azure Active directory 的基本版才可用的功能。 有关详细信息，请参见[Azure Active Directory 版本](https://msdn.microsoft.com/library/azure/dn532272.aspx)。

启用 Microsoft Azure AD 应用程序代理服务器后，您可以发布应用程序来使您的专用网络的外部用户访问。

本部分将引导您完成将发布您希望启用安全的远程访问来自网络之外您本地网络运行的应用程序所必需的步骤。

> [AZURE.NOTE] 要验证正确运行连接器，您发布的第一个应用应该是从专用网络以确保用户可以访问它从 Internet 之前发布实际应用程序中访问任何网站。

## 发布应用程序使用向导

1. 打开您所选择的浏览器并转到 Azure 管理门户。
2. 在 Azure 管理门户的左窗格中，单击撤销选项卡。
3. 单击已启用应用程序代理的目录和您要发布的应用程序 (例如，Wingtip Toys)。
4. 单击**应用程序**选项卡，然后单击**添加**按钮在屏幕底部 ![中添加应用程序](http://i.imgur.com/wEeZ7IR.png)
5. 要在做什么？对话框中，单击**发布，可以访问您的网络之外的应用程序**。 
    ![新应用程序将可以从外部网络访问](http://i.imgur.com/Wj3vkyD.png)

6. 按照提供以下有关您的应用程序的信息在屏幕上的说明︰ ![应用程序属性](http://i.imgur.com/MkPNc93.png)

**设置** | **详细信息**
---|---
外部 URL | 这是用来访问您的专用网络的外部应用程序从云服务的 URL。 基于您提供带有后缀 msappproxy.net 的名称自动生成 URL。
预身份验证方法 | <p>设置您想要使用的应用程序的预身份验证方法的类型︰</p><p>一。 Microsoft Azure Active Directory (Microsoft Azure AD) – 将预身份验证方法设置为 Microsoft Azure Active Directory (Microsoft Azure 的广告)。 当用户试图访问某个应用程序时，应用程序代理服务器会将用户登录用 Azure 的广告，它将进行身份验证的用户，请确保用户具有目录和应用程序所需的权限重定向。</p> <p>b。 通过不通过 – 执行预身份验证。</p>
外部 URL 协议 | <p>默认情况下，通过使用 HTTPS 协议发布应用程序。</p> <p>要启用 HTTP 内部应用程序，您必须将预身份验证设置为直通，然后您就可以将 HTTPS 从外部 URL 协议，改为 HTTP。</p> <p>注意，通过使用 HTTP 发布应用程序可能会创建您的应用程序和您的用户的安全问题。</p> <p>您可以插入自定义的域，而不是使用默认的 msappproxy.net。 有关详细信息，请参阅下面。</p>
内部 URL | 这是内部应用程序代理服务器连接器用于内部访问应用程序的 URL。 这应该是用来访问专用网络中的应用程序从发布的应用程序的 URL。 这是一个有效的 URL 与没有路径不包含空格或符号。

若要完成此向导，请单击屏幕底部的复选标记。 在 Azure 的广告现在定义应用程序。



## 将用户和组分配给应用程序

1. 预身份验证的应用程序，您必须指定用户和组，将有权访问该应用程序。 <p>对于应用程序是直通，都可以为所有用户访问。 但是，为了使用户能够看到在他们的应用程序列表的应用程序，您必须应用程序指派给该用户。
2. 添加应用程序向导后，将显示应用程序代理服务器快速起始页。 若要指定用户，请单击**将用户分配**。
    ![应用程序代理服务器快速启动屏幕](http://i.imgur.com/OmuWElV.png)
3. 选择每个用户或组，您想要分配给此应用程序，然后单击**分配**。 

> [AZURE.NOTE] 用于集成 Windows 身份验证的应用程序，您可以分配只有用户和组同步，prem 在活动目录中。 在使用 Microsoft 帐户和来宾登录的用户无法使用 Azure 活动目录应用程序代理发布的应用程序的分配。 请确保用户分配登录凭据与将要发布的应用程序相同的域的一部分。

## 高级的配置

1. 您可以修改已发布的应用程序或配置高级的选项，例如，从**配置**页面上 prem 应用程序，SSO。
    ![高级的配置](http://i.imgur.com/FhbRvoq.png)

2. 选择应用程序，然后单击**配置**。 提供了以下选项︰

**设置** | **详细信息**
---|---
名称 | 提供描述性名称为您的应用程序
外部 URL | 这是用来访问您的专用网络的外部应用程序从云服务的 URL。 根据您提供带有后缀的名称自动生成 URL **msappproxy.net。**
预身份验证方法 | 设置您想要使用的应用程序的预身份验证方法的类型︰<p>活动目录 – 设置到 Active Directory 的预身份验证的方法。 当用户试图访问某个应用程序时，应用程序代理服务器将重定向用户的身份登录应用程序代理将对进行身份验证的用户，请确保用户具有目录和应用程序所需的权限。</p><p> 通过不通过 – 执行预身份验证。</p>
外部 URL | 默认情况下，通过使用 HTTPS 协议发布应用程序。 要启用 HTTP 内部应用程序，您必须将预身份验证设置为直通，然后您就可以将 HTTPS 从外部 URL 协议，改为 HTTP。 注意，通过使用 HTTP 发布应用程序可能会创建您的应用程序和您的用户的安全问题。 您可以设置自定义的域，而不是使用提供的默认域 (msappproxy.net)。 有关详细信息，请参阅使用自定义的域。
内部 URL | 这是内部应用程序代理服务器连接器用于内部访问应用程序的 URL。 这应该是用来访问专用网络中的应用程序从发布的应用程序的 URL。 这是一个有效的 URL 与没有路径不包含空格或符号。
翻译在标头中的 URL | 为应用程序 （如一些 SharePoint 配置） 都必须采取措施，未翻译的 HTTP 主机标头，将此值设置为 no。 这将禁用标题翻译的请求和响应的标头。
内部身份验证方法 | 如果您使用预身份验证的应用程序代理，您可以设置一个内部身份验证方法，使用户享受到此应用程序的单点登录 (SSO)。 <p> 如果应用程序使用 IWA 并可以配置 Kerberos 约束委派 (KCD) 以启用此应用程序的 SSO，请选中**集成 Windows 身份验证 (IWA)** 。 <p> 如果您的应用程序不使用 IWA，选择**None** 。 <p> 必须使用 KCD 配置使用 IWA 的应用程序，否则应用程序代理服务器将不能将这些应用程序发布。 <p> 有关详细信息，请参阅 SSO 上 Prem IWA 的应用程序使用 KCD 与应用程序代理
内部应用程序 SPN | 这是上 prem 应用程序代理服务器中配置服务主体名称 (SPN) 的内部应用程序。 应用程序代理服务器连接器将使用 SPN 获取 Kerberos 令牌使用 Kerberos 约束委派 (KCD) 的应用程序。 <p> 有关详细信息，请参阅 SSO 上 Prem IWA 的应用程序使用 KCD 与应用程序代理

发布应用程序后使用 Azure 活动目录应用程序代理，它们出现在 Azure 的广告，在应用程序列表，并可以那里管理。
如果已发布的应用程序，您可以禁用应用程序代理服务，这些应用程序不会被删除，但将不再可以从您的专用网络外部访问。
若要查看应用程序并确保可访问，双击该应用程序的名称。 如果禁用该应用程序代理服务器服务和应用程序不可用，在屏幕的顶部会出现一条警告消息。
要删除一个应用程序，请在列表中，选择一个应用程序，然后单击**删除**。

## 其他资源

* [有关 Kerberos 约束委派](http://technet.microsoft.com/library/cc995228.aspx)

测试
