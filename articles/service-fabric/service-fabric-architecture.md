---
ms.openlocfilehash: 31e44dfa049be40700bcd84054ad1431a13b076c
ms.sourcegitcommit: bab1265d669c3e6871daa7cb8a5640a47104947a
translationtype: MT
---
<properties
   pageTitle="服务结构体系结构"
   description="服务结构是一个分布式的系统平台，用于构建可伸缩的、 可靠的和易于管理的云应用程序。 本文介绍服务结构的体系结构。"
   services="service-fabric"
   documentationCenter=".net"
   authors="rishirsinha"
   manager="timlt"
   editor="rishirsinha"/>

<tags
   ms.service="service-fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="04/27/2015"
   ms.author="rsinha"/>

# 服务结构体系结构

服务结构中，如任何平台构建通过多个子系统。 这些子系统一起分层允许应用程序开发人员可以编写应用程序的服务结构︰ 

* 具有高可用性 
* 可扩展， 
* 易于管理和 
* 轻松地测试。

下图显示了体系结构和服务结构的主要子系统。

![](media/service-fabric-architecture/service-fabric-architecture.png)

在分布式系统中，不同节点之间安全地进行通信的能力是至关重要的。 在堆栈的底部是传输子系统，提供了不同的节点之间安全地进行通信的能力。 上述运输子系统存在于联盟子系统，以便系统可以检测故障，执行领导选举并发送 consistenty 到单个实体 （称为群集） 群集不同的节点。 联合身份验证子系统的顶层的可靠性子系统负责通过复制、 资源管理和故障管理等机制的服务结构服务的高可靠性。 联合身份验证子系统还基础托管子系统，用于管理单个节点上的应用程序的生命周期。 群集管理子系统管理应用程序和服务的多计算机生命周期。 可测试性子系统允许应用程序开发人员测试他们的服务通过模拟故障在部署应用程序之前和对生产环境的服务。  服务结构还提供了解决通过其通信子系统服务地点的能力。 在这些 susbsystems，向开发者公开的应用程序的编程模型是分层结构。

## 传输子系统
传输子系统实现点对点数据报的通信通道。 此通道用于群集服务的结构中以及群集服务的结构和客户端之间的通信。 它支持单向和请求-答复通信模式，实现广播和多路广播中较高的层提供的基础。 传输子系统保护通信安全使用 X509 证书或 Windows 安全性。 此子系统服务结构通过在内部使用，不能为应用程序的开发人员直接访问。

## 联合身份验证子系统
为了辨析的一组节点的分布式系统中，我们需要有系统的一致视图。 联合身份验证子系统使用传输子系统提供通信原语和 stitches 到一个统一系统，它可以辨析的各个节点。 它提供了所需的其他子系统的故障检测、 领导者选举和一致路由的分布式的系统基元。 联盟子系统与 128 位标记空间建立在分布式哈希表，并通过具有所有权分配标记空间的子集环中的每个节点的节点创建环形拓扑。 为故障检测层使用基于心跳和仲裁的租赁机制。 联合身份验证子系统还保证通过复杂联接和一个所有者标记的存在随时的离职协议。 这使得我们可以提供领导者选举和路由的保证一致。 

## 子系统的可靠性
可靠性子系统提供的机制，以使服务结构服务状态的高度可以通过_复制器_，_故障转移管理器_和_资源的平衡器_。

* 复制器可确保状态主要服务副本中的更改将自动复制到次要副本，维护服务副本集内主要和次要副本之间的一致性。 复制器负责在副本集中的副本之间的仲裁管理。 它具有故障转移单位获取要复制的操作的列表进行交互，并重新配置代理 (RA) 为其提供的配置副本集，指明哪些复制副本复制到所需要的操作。 服务结构提供了默认复制程序，称为结构复制程序，服务开发人员可用于提高服务状态的高可用性和高可靠性。
* 故障转移管理器可以确保，当添加节点或从群集中删除，会自动重新分发负载跨可用节点。 如果群集中的节点出现故障，群集将自动重新配置服务副本，以便将不会降低可用性。
* 资源平衡器放置在群集中的故障域间服务副本，并确保所有故障转移单位运行。 资源还在共享的基础平衡服务资源平衡器的群集节点，以实现统一的最佳负载分配池。

## 管理子系统
管理子系统提供的端到端的服务和应用程序生命周期管理。 PowerShell Cmdlet 和管理 Api 使您能够调配、 部署、 修补程序、 升级，以及消除调配而不会丢失的应用程序的可用性。 管理子系统来执行此功能通过以下服务。

* 群集管理器-这是与故障转移管理器从可靠性与基于服务放置约束的各个节点放置应用程序进行交互的主要服务。 在故障转移的资源平衡器可确保约束是永远不会中断。 群集管理器管理的规定消除资源调配的应用程序的生命周期。 它集成了下一步中所述的健康管理器来确保在升级过程中不丢失从语义的健康角度考虑应用程序的可用性。
* 健康管理器-此服务启用运行状况监视的应用程序和服务以及群集实体。 （例如，节点、 服务分区和复制副本） 的群集实体可以报告然后聚集到集中式健康状态存储的健康信息。 此健康信息提供服务和节点分布在多个节点在群集中，从而可以采取任何必要的纠正措施的总体时间中的点健康快照。 健康查询 Api 使您能够查询报告给健康子系统运行状况事件。 健康查询 Api 返回存储在状态存储区或特定的群集实体的聚合、 解释健康数据的原始的健康数据。
* 映像存储-此服务允许存储和应用程序的二进制文件的分发。 该服务提供了简单的分布式的文件存储位置到上载和下载的应用程序。


## 宿主的子系统
群集管理器将通知它需要管理特定节点的服务的宿主子系统 （每个节点上运行）。 然后，宿主子系统管理该节点上的应用程序的生命周期。 它交互与可靠性和健全组件，并确保副本的位置正确，运行状况良好。

## 通信子系统
该子系统提供可靠的消息传送中通过命名服务的群集和服务发现。 命名服务将服务名称解析到群集中的某个位置，并允许用户管理服务名称和属性。 使用命名服务，客户端可以安全地与通信服务名称解析和检索服务元数据指定群集中的任何节点。 使用一个简单的命名客户端 API，用户的服务结构可以开发服务和客户端能够解决当前的网络位置，尽管节点动态性或群集的大小。

## 可测试性子系统
可测试性是一套专为测试服务在服务结构上构建的工具。 这些工具允许开发人员轻松地促使有意义的错误和运行测试方案，测试并验证服务在其生命周期内，所有受控且安全的方式将会遇到很多不同的状态和转换。 可测试性还提供了一种机制，通过各种可能的故障运行长时间运行测试，可以循环，而不会丢失用户提供测试在生产环境中的可用性。
 